<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>生徒用ホワイトボード</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="/style.css" rel="stylesheet" />
  <!-- pdf.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc =
      "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";
  </script>
</head>
<body class="app-root">

  <!-- 上部ツールバー（生徒用） -->
  <header class="topbar topbar-student">
    <div class="topbar-left">
      <label>
        クラスコード：
        <input id="studentClassCodeInput" type="text" placeholder="例: ABC123" />
      </label>
      <label>
        ニックネーム：
        <input id="studentNicknameInput" type="text" placeholder="名前" />
      </label>
      <button id="studentJoinBtn">参加</button>
      <span id="studentStatus" class="status-label"></span>
    </div>

    <div class="topbar-right">
      <button id="studentModeWhiteboard" class="tab-button active">
        ホワイトボード共有
      </button>
      <button id="studentModeScreen" class="tab-button">
        全画面共有
      </button>

      <!-- ▼ ホワイトボード保存 / 読み込み（生徒自身のノート用） -->
      <button id="studentSaveBoardBtn" class="topbar-btn">
        💾 保存
      </button>
      <button id="studentLoadBoardBtn" class="topbar-btn">
        📂 読み込み
      </button>
    </div>
  </header>

  <div class="main-layout">
    <!-- 共通：左サイドのホワイトボードツール -->
    <aside class="wb-sidebar" id="wbSidebar">
      <button id="sidebarToggle" class="sidebar-toggle" title="ツールパネルを折りたたむ">
        <span class="chevron">⮜</span>
      </button>

      <section class="wb-section">
        <h3>
          <span class="section-icon">🧰</span>
          <span class="section-text">ツール</span>
        </h3>
        <div class="tool-row">
          <button data-tool="select" class="tool-button" title="選択">
            <span class="icon">🖱️</span><span class="tool-label">選択</span>
          </button>
          <button data-tool="pen" class="tool-button" title="ペン">
            <span class="icon">✏️</span><span class="tool-label">ペン</span>
          </button>
          <button data-tool="highlighter" class="tool-button" title="蛍光ペン">
            <span class="icon">🖍️</span><span class="tool-label">蛍光</span>
          </button>
          <button data-tool="eraser" class="tool-button" title="消しゴム">
            <span class="icon">🧽</span><span class="tool-label">消し</span>
          </button>
        </div>
        <div class="tool-row">
          <button data-tool="text" class="tool-button" title="テキスト">
            <span class="icon">🔤</span><span class="tool-label">テキスト</span>
          </button>
          <button data-tool="sticky" class="tool-button" title="付箋">
            <span class="icon">📝</span><span class="tool-label">付箋</span>
          </button>
        </div>
        <div class="tool-row">
          <button data-tool="rect" class="tool-button" title="四角形">
            <span class="icon">▭</span><span class="tool-label">四角</span>
          </button>
          <button data-tool="ellipse" class="tool-button" title="楕円">
            <span class="icon">⬭</span><span class="tool-label">楕円</span>
          </button>
        </div>
      </section>

      <section class="wb-section">
        <h3>
          <span class="section-icon">📄</span>
          <span class="section-text">ファイル</span>
        </h3>
        <label class="file-button">
          <span class="icon">📎</span>
          <span class="label-text">PDF読み込み</span>
          <input id="pdfInput" type="file" accept="application/pdf" hidden />
        </label>
      </section>

      <section class="wb-section">
        <h3>
          <span class="section-icon">✏️</span>
          <span class="section-text">編集</span>
        </h3>
        <div class="tool-row">
          <button id="undoBtn" class="tool-button">
            <span class="icon">↩️</span><span class="tool-label">元に戻す</span>
          </button>
          <button id="clearBtn" class="tool-button">
            <span class="icon">🗑️</span><span class="tool-label">全消去</span>
          </button>
        </div>
        <div class="tool-row">
          <button id="groupBtn" class="tool-button">
            <span class="icon">🧩</span><span class="tool-label">グループ化</span>
          </button>
          <button id="lockBtn" class="tool-button">
            <span class="icon">🔒</span><span class="tool-label">ロック</span>
          </button>
        </div>
        <div class="tool-row">
          <button id="zoomInBtn" class="tool-button">
            <span class="icon">➕</span><span class="tool-label">拡大</span>
          </button>
          <button id="zoomOutBtn" class="tool-button">
            <span class="icon">➖</span><span class="tool-label">縮小</span>
          </button>
        </div>
      </section>
    </aside>


    <!-- 右側：ホワイトボード本体（生徒側） -->
    <main class="wb-main">
      <div id="boardContainer" class="board-container">
        <canvas id="whiteboard"></canvas>
      </div>

      <!-- 生徒側の画面共有は別で getDisplayMedia を使う（student.js 側で制御） -->
    </main>
  </div>

  <!-- socket.io -->
  <script src="/socket.io/socket.io.js"></script>

  <!-- モジュール -->
  <script type="module" src="/js/student.js"></script>
</body>
</html>
